[{"content":"åƒè€ƒä¾†æº https://github.com/Supporterino/truenas-graphite-to-prometheus\nTurenas app å»ºæ§‹ graphite-to-prometheus åƒç…§ https://github.com/Supporterino/truenas-graphite-to-prometheus/blob/main/TRUENAS.md\nTruenas web \u0026gt; Apps \u0026gt; Discover App \u0026gt; Custom App\nApplication Name: graphite-exporter\nImage repository ghcr.io/supporterino/truenas-graphite-to-prometheus\nå…¶ä»–ä¿æŒé è¨­\nè½‰é“ Port Forwarding\nContainer Port èˆ‡ Node Port\n9109 9109\n9108 9108\néƒ½æ˜¯é è¨­ TCP Protocol\n9109ç”¨æ–¼ Graphite\n9108ç”¨æ–¼ Prometheus\ndocker è£¡å·²é å…ˆå®šç¾©å¥½ graphite_mapping.conf\n1  https://github.com/Supporterino/truenas-graphite-to-prometheus/blob/main/graphite_mapping.conf   Truenas åŒ¯å‡ºå ±å‘Š web \u0026gt; report(å ±å‘Š) \u0026gt; å³ä¸Šè§’ exporters\nThe prefix for the graphite metrics need to be set to truenas\né€™é‚Šè¦æ³¨æ„ prefix å¿…é ˆç‚º truenas\nprometheus åŒ¯å…¥ truenas report prometheus.yml å¢åŠ ä»¥ä¸‹è¨­å®š\n1 2 3 4  # Job, for truenas_exporter - job_name: \u0026#39;truenas_exporter\u0026#39; static_configs: - targets: [\u0026#39;truenas_ip:9108\u0026#39;] # choose port number   ä½ç½®ç‚ºtruenas å€ç¶²ip:9108\n1  docker compose down;docker compose up -d   æœ‰çœ‹åˆ° truenas_exporter (1/1 up) ç¶ ç‡ˆè¡¨ç¤ºé–‹å§‹æ”¶é›†è³‡è¨Šäº†\nGrafana Grafana \u0026gt; Home \u0026gt; Connections \u0026gt;Data sources \u0026gt;Add data source \u0026gt; prometheus å¦‚å…±ç”¨ prometheus\næ‹‰åˆ°æœ€ä¸‹é¢ other é¸é … è‡ªè¨‚æŸ¥è©¢\n1  node_cpu_seconds_total{job=\u0026#34;truenas_exporter\u0026#34;}\u0026amp;node_filesystem_avail_bytes{job=\u0026#34;truenas_exporter\u0026#34;}   save\u0026amp;test ç¶ ç‡ˆ è¡¨ æ¸¬è©¦OK å‰©æœ€å¾Œä¸€æ­¥å›‰~\nDashboards(å„€éŒ¶æ¿) \u0026gt; NEW(å³ä¸Šæ–°å¢é¸é …) \u0026gt; Import dashboard (å³ä¸‹)\nä¸€æ¬¡æ–°å¢ä¸€å€‹jsonæ–‡ä»¶,å…±æ–°å¢ä¸‰å€‹é¢æ¿\nä¸»é¢æ¿\n1  https://github.com/Supporterino/truenas-graphite-to-prometheus/blob/main/dashboards/truenas_scale.json   ç¡¬ç¢Ÿè³‡è¨Š\n1  https://github.com/Supporterino/truenas-graphite-to-prometheus/blob/main/dashboards/truenas_scale_disk_insights.json   æº«åº¦\n1  https://github.com/Supporterino/truenas-graphite-to-prometheus/blob/main/dashboards/truenas_scale_temperatures.json   é–±è®€è³‡è¨Šçš„ä¾¿åˆ©æ¯” truenas web å¥½å¤šäº†,æ„Ÿè¬ cucac å¤§çš„ç ”ç©¶ç²¾ç¥ https://github.com/cucac\nProxmox Influxdb Grafana ç›£æ§æ–¹æ¡ˆ Mudium: https://medium.com/@nykogabriel/how-to-monitor-proxmox-with-grafana-and-influxdb-e55116081867\n","date":"2024-09-21T00:00:00Z","image":"https://loveflee.github.io/p/truenas-grafana/truenas-grafana_hubaa24e4ffe0beeb1b331d6145becaccd_69183_120x120_fill_box_smart1_3.png","permalink":"https://loveflee.github.io/p/truenas-grafana/","title":"Grafana èˆ‡ Truenas èŠ±ç«"},{"content":"åƒè€ƒä¾†æº https://docs.taler.net/system-administration/nginx-prometheus-exporter.html\nhttps://opstree.com/blog/2021/11/09/nginx-monitoring-using-telegraf-prometheus-grafana/\næª¢æŸ¥æ”¯æ´ stub_status èˆ‡å¦ æª¢æŸ¥æ¨¡çµ„æ˜¯å¦å·²å•Ÿç”¨ï¼Œè«‹åŸ·è¡Œï¼š\n1  nginx -V 2\u0026gt;\u0026amp;1 | grep -o with-http_stub_status_module   è¼¸å‡ºè¦çœ‹åˆ° with-http_stub_status_module\né–‹å•Ÿ stub_status 1  nano /etc/nginx/conf.d/stub_status_nginx.conf   è²¼ä¸Šä»¥ä¸‹å…§å®¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  server { listen 81 default_server; root /var/www/html; index index.html index.htm index.nginx-debian.html; server_name _; location / { try_files $uri $uri/ =404; } location /nginx_status { stub_status; allow 127.0.0.1; deny all; } }   æ¸¬è©¦æ˜¯å¦æœ‰éŒ¯èª¤\n1  sudo nginx -t   è¼¸å‡º test is successful è¡¨ç¤ºok nginx é‡è¼‰è¨­å®š\n1  sudo nginx -s reload   ç¢ºä¿æ­£ç¢º\n1  curl http://127.0.0.1:81/nginx_status   è¼¸å‡ºæœƒçœ‹åˆ°\n1 2 3 4  Active connections: 3 server accepts handled requests 268 268 2279 Reading: 0 Writing: 1 Waiting: 2   telegraf å‰å¾€ https://docs.influxdata.com/telegraf/v1/install/\nç…§é é¢æç¤ºå®‰è£\nubuntu çš„ path ä½æ–¼ /etc/telegraf æ›´æ”¹è¨­å®šå‰å…ˆå‚™ä»½\n1  cd /etc/telegraf;cp telegraf.conf bak;rm telegraf.conf   è¤‡è£½è²¼ä¸Šè¨­å®šæª”\n1  nano telegraf.conf   è²¼ä¸Š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  [global_tags] [agent] interval = \u0026#34;60s\u0026#34; round_interval = true metric_batch_size = 1000 metric_buffer_limit = 10000 collection_jitter = \u0026#34;0s\u0026#34; flush_interval = \u0026#34;30s\u0026#34; flush_jitter = \u0026#34;0s\u0026#34; debug = false quiet = false logfile = \u0026#34;/var/log/telegraf/telegraf.log\u0026#34; omit_hostname = false [[inputs.nginx]] urls = [\u0026#34;http://127.0.0.1:81/nginx_status\u0026#34;] response_timeout = \u0026#34;5s\u0026#34; [[inputs.tail]] name_override = \u0026#34;nginxlog\u0026#34; files = [\u0026#34;/var/log/nginx/access.log\u0026#34;] from_beginning = true pipe = false data_format = \u0026#34;grok\u0026#34; grok_patterns = [\u0026#34;%{COMBINED_LOG_FORMAT}\u0026#34;] [[inputs.cpu]] percpu = true [[inputs.disk]] [[inputs.diskio]] [[inputs.net]] [[inputs.mem]] [[inputs.system]] ## è¼¸å‡ºè¨­å®š telegraf port [[outputs.prometheus_client]] listen = \u0026#34;0.0.0.0:9113\u0026#34;   é‡å•Ÿè¼‰å…¥\n1  systemctl restart telegraf   å¦‚æœ‰éŒ¯èª¤ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤é™¤éŒ¯\n1  journalctl --no-pager --unit telegraf   å¦‚é¡¯ç¤ºç„¡æ³•æ‰“é–‹æ—¥èªŒ,ä¿®æ­£æ¬Šé™\n1  chown -R telegraf:telegraf /var/log/telegraf   å› åªæœ‰ä¸€å€‹è¦å¾Œæ‹‹æœ‰ä¿®æ”¹åªé™è®€å– ImportCredential=telegraf.conf\nnano /etc/systemd/system/multi-user.target.wants/telegraf.service\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  [Unit] Description=Telegraf Documentation=https://github.com/influxdata/telegraf After=network-online.target Wants=network-online.target [Service] Type=notify NotifyAccess=all EnvironmentFile=-/etc/default/telegraf User=telegraf ImportCredential=telegraf.conf ExecStart=/usr/bin/telegraf -config /etc/telegraf/telegraf.conf -config-directory /etc/telegraf/telegraf.d $TELEGRAF_OPTS ExecReload=/bin/kill -HUP $MAINPID Restart=on-failure RestartForceExitStatus=SIGPIPE KillMode=mixed LimitMEMLOCK=8M:8M PrivateMounts=true [Install] WantedBy=multi-user.target   é‡è¼‰å…¥ systemd\n1  systemctl daemon-reload;systemctl start telegraf.service;systemctl status telegraf.service   nginx-prometheus-exporter ç‰ˆæœ¬è³‡è¨Š url: https://github.com/nginxinc/nginx-prometheus-exporter/tags\ncli\n1 2 3 4 5 6  mkdir -p /tmp/nginx_exporter_tmp \u0026amp;\u0026amp; cd /tmp/nginx_exporter_tmp mkdir -p /opt/nginx-exporter wget https://github.com/nginxinc/nginx-prometheus-exporter/releases/download/v1.3.0/nginx-prometheus-exporter_1.3.0_linux_amd64.tar.gz tar axf nginx-prometheus-exporter_1.3.0_linux_amd64.tar.gz chown nginx-exporter:nginx-exporter * cp -r * /opt/nginx-exporter/   å‰µå°ˆç”¨ä½¿ç”¨è€… æŒ‡å®šæ²’æœ‰å®¶ç›®éŒ„ ç„¡æ³•ä½¿ç”¨ shell\n1  useradd --system --no-create-home --shell /bin/false nginx-exporter   systemd å•Ÿç”¨æœå‹™\n1  nano /etc/systemd/system/nginx-exporter.service   è²¼ä¸Š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  [Unit] Description=NGINX Prometheus Exporter Wants=network-online.target After=network-online.target StartLimitIntervalSec=0 [Service] User=nginx-exporter Group=nginx-exporter Type=simple Restart=on-failure RestartSec=5s ExecStart=/opt/nginx-exporter/nginx-prometheus-exporter --nginx.scrape-uri=http://localhost:81/nginx_status --web.systemd-socket [Install] WantedBy=multi-user.target   é©—è­‰ å¦‚ç„¡è³‡è¨Šè¼¸å‡º,è¡¨ç¤ºä¹‹å‰æœ‰éŒ¯èª¤çš„åœ°æ–¹!!\n1  curl http://localhost:9113/metrics   socket å¯ä»¥çœç•¥éƒ¨ä»½,éå¿…è¦\n1  nano /etc/systemd/system/nginx-exporter.socket   è²¼ä¸Š\n1 2 3 4 5 6 7 8  [Unit] Description=NGINX Prometheus Exporter [Socket] ListenStream=9113 [Install] WantedBy=sockets.target   æœ‰ä¿®æ”¹éœ€é‡è¼‰å…¥systemd\n1  systemctl daemon-reload   æ‰“é–‹ é–‹æ©Ÿå•Ÿå‹• èˆ‡ é¦¬ä¸Šé–‹å§‹æœå‹™\n1  systemctl enable nginx-exporter.service;systemctl start nginx-exporter.service;systemctl status nginx-exporter.service   prometheus è¨­å®šæª”å¢åŠ ä¾†æº\n1  nano /etc/prometheus/prometheus.yml   æœ¬æ©Ÿå®‰è£ prometheus\n1 2 3 4  # Job, for nginx_exporter - job_name: \u0026#39;nginx_exporter\u0026#39; static_configs: - targets: [\u0026#39;localhost:9113\u0026#39;] # choose port number   docker-compose.yaml ä½¿ç”¨ docker compose å¦‚éæœ¬æ©Ÿ,å‰‡ç‚º docker_host æ‰€åœ¨ ip\ndocker-compose.yaml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  #version: \u0026#34;3\u0026#34; services: prometheus: image: prom/prometheus container_name: prometheus ports: - \u0026#39;9090:9090\u0026#39; volumes: - ./data/prometheus:/etc/prometheus - /etc/timezone:/etc/timezone networks: - monitor influxdb: image: influxdb container_name: influxdb ports: - \u0026#34;8086:8086\u0026#34; restart: always volumes: - ./data/influxdb:/var/lib/influxdb2:rw - /etc/timezone:/etc/timezone networks: - monitor grafana: image: grafana/grafana container_name: grafana user: \u0026#39;1000\u0026#39; ports: - \u0026#34;3000:3000\u0026#34; restart: always networks: - monitor volumes: - ./data/grafana:/var/lib/grafana - /etc/timezone:/etc/timezone # environment: # - GF_SERVER_ROOT_URL=http://grafana_ip:3000 # - GF_AUTH_DISABLE_LOGIN_FORM=false # - GF_AUTH_GOOGLE_ENABLED=true # - GF_AUTH_GOOGLE_CLIENT_ID=012345678912-testestest.apps.googleusercontent.com # - GF_AUTH_GOOGLE_CLIENT_SECRET=rhtsjyrkjytjkydtjyjdyj # - GF_AUTH_GOOGLE_ALLOWED_DOMAINS=grafana.com # - GF_AUTH_GOOGLE_ALLOW_SIGN_UP=true networks: monitor:   prometheus è¨­å®šæª”å¢åŠ ä¾†æº\n/home/carter/grafana/data/prometheus/prometheus.yml\n1 2 3 4  # Job, for nginx_exporter - job_name: \u0026#39;nginx_exporter\u0026#39; static_configs: - targets: [\u0026#39;nginx_ip:9113\u0026#39;] # choose port number   ","date":"2024-09-20T00:00:00Z","image":"https://loveflee.github.io/p/grafana/grafana_hu79784a093fb7c5c72dd38a1ce913641f_133743_120x120_fill_box_smart1_3.png","permalink":"https://loveflee.github.io/p/grafana/","title":"Nginx-Prometheus-Exporter"},{"content":"åƒè€ƒä¾†æº github Modsecurity\n2024-09-16 ç•¶å‰ç‚º OWASP_CRS/4.6.0\ndocker modsecurity\ndocker compose nginx\nåƒæ•¸è¨­ç½®èªªæ˜\nå®˜ç‰ˆ docker-compose.yaml\ndocker-compose.yaml my docker-docmpose.yaml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  version: \u0026#39;3\u0026#39; services: waf: image: owasp/modsecurity-crs:nginx container_name: waf ports: - \u0026#34;80:80\u0026#34; # å°‡å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æ©Ÿçš„80ç«¯å£ - \u0026#34;443:443\u0026#34; # å¦‚æœéœ€è¦ HTTPSï¼Œä¹Ÿå¯ä»¥æ˜ å°„443ç«¯å£ # - \u0026#34;12081:8080\u0026#34; volumes: - /etc/localtime:/etc/localtime - ./nginx.conf.template:/etc/nginx/templates/nginx.conf.template:rw # æ›è¼‰è‡ªå®šç¾©çš„ Nginx é…ç½®æ–‡ä»¶ - ./main.conf:/etc/nginx/templates/main.conf:rw # - ./conf.d:/etc/nginx/conf.d # å¯é¸ï¼šæ›è¼‰è‡ªå®šç¾©çš„ ModSecurity é…ç½®æ–‡ä»¶ - ./mysite:/etc/nginx/mysite:rw - ./ssl/domain:/etc/ssl/domain:ro - ./crs:/etc/modsecurity.d/owasp-crs/crs:rw environment: - PARANOIA=1 # è¨­ç½® paranoia level, é»˜èªæ˜¯ PL1 restart: always   plugin ä¸»é  github\nnextcloud\nWordPress\nModsecurity path docker è£¡çš„è·¯å¾‘çµæ§‹\n1  docker compose exec waf bash   modsecurity conf\n1  /etc/modsecurity.d/modsecurity.conf   rule path\n1  /etc/modsecurity.d/owasp-crs/rules   plugin path å¤–æ›æ”¾ç½®è·¯å¾‘\n1  /etc/modsecurity.d/owasp-crs/plugins   è¨­ç½®plugin nginx conf\n1 2 3  server { modsecurity on; modsecurity_rules_file /etc/modsecurity.d/owasp-crs/crs/cloud.conf;   nextcloud plugin æ›¿æ› crs ç‚ºdocker è·¯å¾‘çµæ§‹ /etc/modsecurity.d/owasp-crs/crs\ncloud.conf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  # è¦†è“‹è«‹æ±‚é™åˆ¶ # é™åˆ¶æœ‰æª”åçš„æ–‡ä»¶æœ€å¤§ä¸Šå‚³ 10GB = 131072000 SecRequestBodyLimit 10737418240 # è¶…éè¨­ç½®çš„æ‹’çµ• SecRequestBodyLimitAction Reject # é™åˆ¶æ²’æœ‰æª”åçš„æ–‡ä»¶æœ€å¤§ä¸Šå‚³ 256k SecRequestBodyNoFilesLimit 262144 # ç‚ºLocalhost-nginxç·¨è­¯é€£çµå™¨ç‰ˆæœ¬æ ¹æ“šdockerçµæ§‹ç·¨ä¿® Include /etc/modsecurity.d/owasp-crs/crs/nextcloud-rule-exclusions-plugin/exclude.conf Include /etc/modsecurity.d/owasp-crs/crs/nextcloud-rule-exclusions-plugin/nextcloud-rule-exclusions-before.conf Include /etc/modsecurity.d/owasp-crs/crs/nextcloud-rule-exclusions-plugin/nextcloud-rule-exclusions-config.conf Include /etc/modsecurity.d/modsecurity.conf Include /etc/modsecurity.d/owasp-crs/crs-setup.conf Include /etc/modsecurity.d/owasp-crs/rules/*.conf   exclude.conf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  SecRule \u0026amp;TX:nextcloud-rule-exclusions-plugin_enabled \u0026#34;@eq 0\u0026#34; \\ \u0026#34;id:9508010,\\ phase:1,\\ pass,\\ nolog,\\ ver:\u0026#39;nextcloud-rule-exclusions-plugin/1.2.0\u0026#39;,\\ setvar:\u0026#39;tx.nextcloud-rule-exclusions-plugin_enabled=1\u0026#39;\u0026#34; # æœ‰äº›æª”åæœƒè¢«å°é– æ’é™¤ç›®éŒ„è¦å‰‡ id=930130 åœ¨ç‰¹å®šç›®éŒ„ä¸‹çš„æ‡‰ç”¨ SecRule REQUEST_URI \u0026#34;@beginsWith /remote.php/dav/files/username1/blog/\u0026#34; \\ \u0026#34;id:10001,phase:1,nolog,pass,t:none,ctl:ruleRemoveById=930130\u0026#34; # èªªæ˜ï¼š # - id:10001 æ˜¯é€™æ¢è¦å‰‡çš„ IDï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„ ID ä¾†å€åˆ†ã€‚ # - phase:1 æŒ‡å®šè¦å‰‡åœ¨å“ªå€‹éšæ®µåŸ·è¡Œï¼ˆé€šå¸¸åœ¨ç¬¬ 1 éšæ®µæ‡‰ç”¨ï¼‰ã€‚ # - nolog å’Œ pass æŒ‡ç¤ºç•¶åŒ¹é…æ™‚ä¸è¨˜éŒ„æ—¥å¿—ä¸¦å…è¨±è«‹æ±‚ç¹¼çºŒã€‚ # - ctl:ruleRemoveById=930130 è¡¨ç¤ºåœ¨åŒ¹é…åˆ°æ­¤ URI æ™‚æ’é™¤è¦å‰‡ 930130 çš„æ‡‰ç”¨ã€‚ # ä½¿ç”¨æ­£å‰‡è¡¨é”å¼åŒ¹é…å¤šå€‹ç›®éŒ„ #SecRule REQUEST_URI \u0026#34;@rx ^/remote\\.php/dav/files/(username1/blog|username2/projects|username3/documents)/\u0026#34; \\ # \u0026#34;id:10004,phase:1,nolog,pass,t:none,ctl:ruleRemoveById=930130\u0026#34; # æ”¾å¯¬æ–‡ä»¶ä¸Šå‚³é™åˆ¶ SecRule REQUEST_FILENAME \u0026#34;@rx /(?:remote\\.php|index\\.php)/\u0026#34; \\ \u0026#34;id:10002,phase:2,t:none,nolog,pass,setvar:\u0026#39;tx.restricted_extensions=.bak/ .config/ .conf/\u0026#39;\u0026#34;   æ ¹æ“šnextcloud pluginè¦æ±‚ å¤–æ›å‘½åç‚º crs/nextcloud-rule-exclusions-plugin\nå¾Œå°‡å…©å€‹confæ”¾ç½®å…¶ä¸‹ nextcloud-rule-exclusions-before.conf èˆ‡ nextcloud-rule-exclusions-config.conf\nä¾†åŸ: nextcloud plugin\nåŠ å¤§apache2å®¹å™¨ä¸Šå‚³ è§£æ±ºåœ¨ç¶²é ä¸Šå‚³ 413 å•é¡Œ\nfile/Dockerfile-app\n1 2 3 4 5  # å¢åŠ ä¸Šå‚³ 16GB = 17179869184 RUN echo \u0026#34;LimitRequestBody 17179869184\u0026#34; \u0026gt;\u0026gt; /etc/apache2/apache2.conf # é‡å•Ÿ Apache è¼‰å…¥æ–°è¨­å®š RUN apachectl restart   è‡³æ­¤ modsceurity è¨­ç½®å®Œæˆ\n","date":"2024-09-16T00:00:00Z","image":"https://loveflee.github.io/p/x/modsecurity_hu07e0207d2f477942fe3c45c7afc821d3_15909_120x120_fill_box_smart1_3.png","permalink":"https://loveflee.github.io/p/x/","title":"modsecurity"},{"content":"proxmox é–‹æºä½œæ¥­ç³»çµ± Proxmox\nVm: Home Assistant Vm HA\nLxc Docker Nextcloud Lxc Docker fpm-nextcloud-nginx\nLxc Docker Jellyfin Nvidia Gpu Jellyfin æ­é… Nvidia Gpu P600 è½‰æª”åŠ é€Ÿ\nVm Truenas Vm Truenas ç”¨ä¾†å‚™ä»½ pve dataset\n","date":"2024-07-24T00:00:00Z","image":"https://loveflee.github.io/p/pve/a0pve01_hu42be8b8ff55ad2150ad7ec4a7ed5d8cd_88705_120x120_fill_box_smart1_3.png","permalink":"https://loveflee.github.io/p/pve/","title":"ç”¨ Proxmox æ§‹å»ºå®¶ç”¨ä¼ºæœå™¨"},{"content":"Frigate å®˜æ–¹ç¶²ç«™ æ›´æ–°æ–¼2024/08/28 https://frigate.video/ èªªæ˜æ–‡ä»¶ https://docs.frigate.video/\nNvidia docker-compose.yaml ubuntu 22.04 docker compose frigate/ æ³¨æ„ï¼šnvidia-drive nvidia-docker2\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  version: \u0026#39;3.9\u0026#39; services: frigate: container_name: frigate privileged: true restart: unless-stopped image: ghcr.io/blakeblackshear/frigate:0.12.0-tensorrt # runtime: nvidia deploy: resources: reservations: devices: - capabilities: [gpu] shm_size: \u0026#34;512mb\u0026#34; # update for your cameras based on calculation above # devices: # - /dev/bus/usb:/dev/bus/usb #coral tpu AIè¾¨è­˜ # - /dev/apex_0:/dev/apex_0 #ç›´é€š PCIe Coral,driver \u0026gt; https://coral.ai/docs/m2/get-started/#2a-on-linux # - /dev/dri/renderD128 # for intel gpu hardware volumes: - /etc/localtime:/etc/localtime:ro - ./config:/config - ./trt-models:/trt-models # - ./nvr-data:/media/frigate # - /vm31/nvr-data:/media/frigate - /root/smb:/media/frigate - type: tmpfs # Optional: 1GB of memory, reduces SSD/SD Card wear target: /tmp/cache tmpfs: size: 1000000000 ports: - \u0026#34;5000:5000\u0026#34; - \u0026#34;1935:1935\u0026#34; # RTMP feeds - \u0026#34;8554:8554\u0026#34; # RTSP feeds - \u0026#34;8555:8555/tcp\u0026#34; # WebRTC over tcp - \u0026#34;8555:8555/udp\u0026#34; # WebRTC over udp environment: FRIGATE_RTSP_PASSWORD: \u0026#34;passwd\u0026#34; NVIDIA_VISIBLE_DEVICES: all NVIDIA_DRIVER_CAPABILITIES: compute,video,utility   Nvidia config/cnfig.yml å®˜ç¶²é…ç½®èªªæ˜ https://docs.frigate.video/configuration/ tensorrt å»ºæ§‹ https://docs.frigate.video/configuration/detectors#nvidia-tensorrt-detector  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201  ui: use_experimental: false live_mode: mse mqtt: enabled: true host: ha ip port: 1883 topic_prefix: frigate client_id: frigate user: mqttuser password: mqttuser stats_interval: 300 ffmpeg: hwaccel_args: preset-nvidia-h264 #nvidia gpu output_args: record: preset-record-generic-audio-aac #sound out # hwaccel_args: preset-vaapi #éŒ„å½±ç§’æ•¸ record: expire_interval: 15 enabled: True retain: days: 7 mode: motion # è¨»è§£æ‰ mode:é€£çºŒéŒ„å½± motion é‹å‹•æª¢æ¸¬ active_objects ç‰©é«”ç§»å‹• all åŒ…å«é‹å‹•è·Ÿç‰©é«” events: # pre_capture: 3 #åµæ¸¬éŒ„å½±å‰æå‰1ç§’ # post_capture: 3 #åµæ¸¬éŒ„å½±å¾Œå‰ªè¼¯å¾€å¾Œ3ç§’ retain: default: 14 mode: active_objects objects: person: 7 #åµæ¸¬å™¨(é‹å‹•æª¢æ¸¬) detectors: tensorrt: type: tensorrt device: 0 #This is the default, select the first GPU model: path: /trt-models/yolov7-tiny-416.trt input_tensor: nchw input_pixel_format: rgb width: 416 height: 416 objects: track: - person filters: person: min_area: 5000 max_area: 100000 snapshots: enabled: True clean_copy: True timestamp: False bounding_box: True crop: False height: 175 required_zones: [] retain: default: 7 objects: person: 7 #éŒ„å½±æ™‚é–“æˆ³è¨­ç½®åƒæ•¸ timestamp_style: position: \u0026#34;tl\u0026#34; #\u0026#34;tl\u0026#34; (top left), \u0026#34;tr\u0026#34; (top right), \u0026#34;bl\u0026#34; (bottom left), \u0026#34;br\u0026#34; (bottom right) format: \u0026#34;%m/%d/%Y %H:%M:%S\u0026#34; color: red: 255 green: 255 blue: 255 thickness: 2 effect: shadow go2rtc: streams: gate: - \u0026#34;ffmpeg:rtsp://admin:pwsswd@192.168.88.53:554/stream1#video=copy#audio=copy#audio=aac\u0026#34; gate_sub: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.53:554/stream2#video=copy#audio=copy#audio=aac\u0026#34; 3f: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.54:554/stream1#video=copy#audio=copy#audio=aac\u0026#34; 3f_sub: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.54:554/stream2#video=copy#audio=copy#audio=aac\u0026#34; webrtc: candidates: - 127.0.0.1:8555 - stun:8555 cameras: gate: ffmpeg: inputs: - path: rtsp://127.0.0.1:8554/gate input_args: preset-rtsp-restream roles: - record - path: rtsp://127.0.0.1:8554/gate_sub input_args: preset-rtsp-restream roles: - detect record: enabled: True detect: width: 640 height: 360 fps: 7 objects: track: - person filters: person: mask: - 0,190,135,128,138,90,252,95,270,149,483,165,561,360,640,360,640,0,0,0 min_score: 0.4 threshold: 0.5 min_area: 700 snapshots: enabled: true timestamp: true bounding_box: true crop: True height: 500 retain: default: 3 zones: zone_0: coordinates: 282,360,552,360,482,164,271,163,271,90,225,92,141,85,136,129,0,201,0,360 motion: mask: - 478,178,566,360,640,360,640,0,359,0,0,0,0,89,273,90,279,152 - 148,135,159,0,0,0,0,198 3f: ffmpeg: inputs: - path: rtsp://127.0.0.1:8554/3f input_args: preset-rtsp-restream roles: - record - path: rtsp://127.0.0.1:8554/3f_sub input_args: preset-rtsp-restream roles: - detect record: enabled: True detect: width: 640 height: 360 fps: 5 objects: track: - person filters: person: mask: - 0,0,0,311,640,307,640,360,0,360 min_score: 0.4 threshold: 0.5 min_area: 700 zones: zone_0: coordinates: 640,360,640,42,0,39,0,360 motion: mask: - 640,110,640,0,0,0,0,33 snapshots: enabled: true timestamp: true bounding_box: true crop: True height: 500 retain: default: 3 #detectors: # coral: # type: edgetpu # device: usb rtmp: enabled: false birdseye: enabled: True restream: False width: 1920 height: 1080 quality: 8 mode: continuous live: height: 640 quality: 1   Intel Gpu docker-compose.yaml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  version: \u0026#39;3.9\u0026#39; services: frigate: container_name: frigate privileged: true restart: unless-stopped image: ghcr.io/blakeblackshear/frigate:stable cap_add: - CAP_PERFMON shm_size: \u0026#34;128mb\u0026#34; # update for your cameras based on calculation above devices: # - /dev/bus/usb:/dev/bus/usb #coral tpu AIè¾¨è­˜ # - /dev/apex_0:/dev/apex_0 #ç›´é€š PCIe Coral,driver \u0026gt; https://coral.ai/docs/m2/get-started/#2a-on-linux - /dev/dri/renderD128 # for intel gpu hardware volumes: - /etc/localtime:/etc/localtime:ro - ./config:/config # - ./nvr-data:/media/frigate - /root/smb:/media/frigate - type: tmpfs # Optional: 1GB of memory, reduces SSD/SD Card wear target: /tmp/cache tmpfs: size: 1000000000 ports: - \u0026#34;5000:5000\u0026#34; - \u0026#34;1935:1935\u0026#34; # RTMP feeds - \u0026#34;8554:8554\u0026#34; # RTSP feeds - \u0026#34;8555:8555/tcp\u0026#34; # WebRTC over tcp - \u0026#34;8555:8555/udp\u0026#34; # WebRTC over udp environment: FRIGATE_RTSP_PASSWORD: \u0026#34;passwd\u0026#34;   Intel Gpu config/config.yml å®˜ç¶²é…ç½®èªªæ˜ https://docs.frigate.video/configuration/ OpenVINOæª¢æ¸¬å™¨ https://docs.frigate.video/configuration/detectors#openvino-detector 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205  ui: use_experimental: false live_mode: mse mqtt: enabled: true host: ha ip port: 1883 topic_prefix: frigate client_id: frigate user: mqttuser password: mqttuser stats_interval: 300 #intel gpu è¼¸å‡ºè²éŸ³(éŒ„å½±) ffmpeg: hwaccel_args: preset-vaapi output_args: record: preset-record-generic-audio-aac #éŒ„å½±ç§’æ•¸ record: expire_interval: 10 enabled: True retain: days: 7 mode: motion # è¨»ï€ƒè§£ï€ƒæ‰ï€ƒmode 7/24éŒ„ï€ƒå½±ï€ƒ motioné‹ï€ƒå‹•ï€ƒæª¢ï€ƒæ¸¬ï€ƒ active_objectsç‰©ï€ƒé«”ï€ƒç§»ï€ƒå‹•ï€ƒ allåŒ…ï€ƒå«ï€ƒé‹ï€ƒå‹•ï€ƒè·Ÿï€ƒç‰©ï€ƒé«”ï€ƒ events: pre_capture: 4 #åµæ¸¬éŒ„å½±å‰æå‰1ç§’ post_capture: 3 #åµæ¸¬éŒ„å½±å¾Œå‰ªè¼¯å¾€å¾Œ3ç§’ retain: default: 14 mode: active_objects objects: person: 7 #åµæ¸¬å™¨(é‹å‹•åµæ¸¬) detectors: ov: type: openvino device: AUTO model: path: /openvino-model/ssdlite_mobilenet_v2.xml model: width: 300 height: 300 input_tensor: nhwc input_pixel_format: bgr labelmap_path: /openvino-model/coco_91cl_bkgr.txt objects: track: - person filters: person: min_area: 5000 max_area: 100000 snapshots: enabled: True clean_copy: True timestamp: False bounding_box: True crop: False height: 175 required_zones: [] retain: default: 7 objects: person: 7 #éŒ„å½±æ™‚é–“æˆ³è¨­ç½®åƒæ•¸ thickness:å­—é«”å¤§å° effect:å­—é«”é™°å½± timestamp_style: position: \u0026#34;tl\u0026#34; format: \u0026#34;%m/%d/%Y %H:%M:%S\u0026#34; color: red: 255 green: 255 blue: 255 thickness: 2 effect: shadow go2rtc: streams: gate: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.53:554/stream1#video=copy#audio=copy#audio=aac\u0026#34; gate_sub: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.53:554/stream2#video=copy#audio=copy#audio=aac\u0026#34; 3f: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.54:554/stream1#video=copy#audio=copy#audio=aac\u0026#34; 3f_sub: - \u0026#34;ffmpeg:rtsp://admin:passwd@192.168.88.54:554/stream2#video=copy#audio=copy#audio=aac\u0026#34; webrtc: candidates: - 127.0.0.1:8555 - stun:8555 cameras: gate: ffmpeg: inputs: - path: rtsp://127.0.0.1:8554/gate input_args: preset-rtsp-restream roles: - record - path: rtsp://127.0.0.1:8554/gate_sub input_args: preset-rtsp-restream roles: - detect record: enabled: True detect: width: 640 height: 360 fps: 5 objects: track: - person filters: person: mask: - 0,190,135,128,138,90,252,95,270,149,483,165,561,360,640,360,640,0,0,0 min_score: 0.4 threshold: 0.5 min_area: 700 snapshots: enabled: true timestamp: true bounding_box: true crop: True height: 500 retain: default: 3 zones: zone_0: coordinates: 282,360,552,360,482,164,271,163,271,90,225,92,141,85,136,129,0,201,0,360 motion: mask: - 478,178,566,360,640,360,640,0,359,0,0,0,0,89,273,90,279,152 - 148,135,159,0,0,0,0,198 3f: ffmpeg: inputs: - path: rtsp://127.0.0.1:8554/3f input_args: preset-rtsp-restream roles: - record - path: rtsp://127.0.0.1:8554/3f_sub input_args: preset-rtsp-restream roles: - detect record: enabled: True detect: width: 640 height: 360 fps: 5 objects: track: - person filters: person: mask: # - 0,360,640,360,640,47,0,44 min_score: 0.4 threshold: 0.5 min_area: 700 zones: zone_0: coordinates: 640,360,640,42,0,39,0,360 motion: mask: - 640,110,640,0,0,0,0,33 snapshots: enabled: true timestamp: true bounding_box: true required_zones: - gateclose_in - gate_whole_area crop: True height: 500 retain: default: 3 #detectors: # coral: # type: edgetpu # device: usb rtmp: enabled: false birdseye: enabled: True restream: False width: 1920 height: 1080 quality: 8 mode: continuous live: height: 640 quality: 1   HA onvif and ptz ha å…ˆç”¨ onvif camera å°å…¥ ipcam onvif æ§åˆ¶ ipcam  Ha è¨­å®š \u0026gt; è‡ªå‹•åŒ– \u0026gt; è…³æœ¬ \u0026gt; yamlç·¨è¼¯ è²¼ä¸Šå¾Œå†ç”¨è¦–è¦ºåŒ–ç·¨è¼¯ \u0026gt; é€£çºŒ é¸å– ipcam distance: 0.12 \u0026lt; ç§»å‹•é€Ÿåº¦èª¿æ•´   å·¦\n1 2 3 4 5 6 7 8 9 10  alias: turn_left sequence: - service: onvif.ptz data: pan: RIGHT distance: 0.12 target: device_id: 24ff4dd62b369f46d24f99486240f22f mode: single icon: mdi:arrow-left-bold-circle   å³\n1 2 3 4 5 6 7 8 9 10  alias: turn_right sequence: - service: onvif.ptz data: pan: LEFT distance: 0.12 target: device_id: 24ff4dd62b369f46d24f99486240f22f mode: single icon: mdi:arrow-right-bold-circle   ä¸Š\n1 2 3 4 5 6 7 8 9 10  alias: turn_up sequence: - service: onvif.ptz data: distance: 0.12 tilt: DOWN target: device_id: 24ff4dd62b369f46d24f99486240f22f mode: single icon: mdi:arrow-up-bold-circle   ä¸‹\n1 2 3 4 5 6 7 8 9 10  alias: turn_down sequence: - service: onvif.ptz data: distance: 0.12 tilt: UP target: device_id: 24ff4dd62b369f46d24f99486240f22f mode: single icon: mdi:arrow-down-bold-circle   é è¨­é» (æ–¼ IPcam-APP è£¡è¨­å®š)\n1 2 3 4 5 6 7 8 9 10 11  alias: preset1 sequence: - service: onvif.ptz data: distance: 0.12 preset: \u0026#34;1\u0026#34; move_mode: GotoPreset target: device_id: 24ff4dd62b369f46d24f99486240f22f mode: single icon: mdi:arrow-collapse-all   æ‹‰è¿‘(æ”¾å¤§ç‰©é«”)\n1 2 3 4 5 6 7 8 9 10  alias: 3f_in sequence: - service: onvif.ptz data: distance: 0.15 zoom: ZOOM_IN target: device_id: 1f5322054b437303a2af54ad0e6f053c mode: single icon: mdi:arrow-expand   æ‹‰é (ç¸®å°ç‰©é«”)\n1 2 3 4 5 6 7 8 9 10  alias: 3f_out sequence: - service: onvif.ptz data: distance: 0.15 zoom: ZOOM_OUT target: device_id: 1f5322054b437303a2af54ad0e6f053c mode: single icon: mdi:arrow-collapse   HA frigate card æ–¼ ha å…§ä½¿ç”¨ frigate card hacs å°å…¥ frigate card   å‚ç›´å¡ ( frigate card åŠ  æ°´å¹³å¡ - onvif æ§åˆ¶ )  entity: script.1702054234951 entity: script.1702057221703 entity: script.turn_down entity: script.turn_right 4å€‹ entity ç‚ºç§»å‹•æ§åˆ¶è…³æœ¬  éœ€ä¿®æ”¹å°æ‡‰åˆ°æ­£ç¢ºåç¨±,å»ºè­°å„å‹•ä½œéƒ½æª¢æŸ¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79  type: vertical-stack cards: - type: custom:frigate-card cameras: - camera_entity: camera.gate live_provider: jsmpeg hide: false view: timeout_seconds: 0 update_force: false update_cycle_camera: false default: live update_seconds: 0 live: preload: true zoomable: true lazy_load: true microphone: always_connected: true menu: buttons: \u0026#39;mute:\u0026#39;: enable: true microphone: enabled: true alignment: matching icon: mdi:microphone-settings type: momentary play: enable: true microphone: enabled: true alignment: matching icon: mdi:microphone type: momentary alignment: bottom style: outside - type: horizontal-stack cards: - type: custom:button-card show_name: true show_icon: true tap_action: action: toggle entity: script.1702054234951 name: L icon_height: 20px - type: custom:button-card show_name: true show_icon: true tap_action: action: toggle entity: script.1702057221703 name: Up icon_height: 20px - type: custom:button-card show_name: true show_icon: true tap_action: action: toggle entity: script.turn_down name: Down icon_height: 20px - type: custom:button-card show_name: true show_icon: true tap_action: action: toggle entity: script.turn_right name: R icon_height: 20px - type: custom:button-card show_name: true show_icon: true tap_action: action: toggle entity: script.preset1 name: G-P icon_height: 20px   Line é€šçŸ¥è§¸ç™¼åµæ¸¬ Lineé€šçŸ¥æ•™å­¸ Line Notify  https://github.com/loveflee/autosend-photo-inha-line è¨­å®š \u0026gt; è‡ªå‹•åŒ– \u0026gt; æ–°å¢è‡ªå‹•åŒ– \u0026gt; å³ä¸Šä¸‰å°é»ä»¥YAMLç·¨è¼¯ è¤‡è£½è²¼ä¸Šå¾Œå†ä»¥è¦–è¦ºåŒ–ç·¨è¼¯å»ä¿®æ­£å„å€‹è¨­ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  alias: é›»å‹•é–€ç§»å‹•é”3ç§’åµæ¸¬ description: è»Šåº«äººå½¢åµæ¸¬ trigger: - platform: state entity_id: - binary_sensor.gate_person_occupancy for: hours: 0 minutes: 0 seconds: 3 to: \u0026#34;on\u0026#34; from: \u0026#34;off\u0026#34; condition: - condition: time after: \u0026#34;00:05:00\u0026#34; before: \u0026#34;07:00:00\u0026#34; enabled: false action: - service: notify.line_notification data: message: Gate all occupancy ç§»å‹•åµæ¸¬å·²é”4ç§’ - service: camera.record data: lookback: 0 filename: /media/\u0026#39;{{(\u0026#39;%Y%m%d%H%M\u0026#39;) }}\u0026#39;.mp4 duration: 20 target: device_id: 24ff4dd62b369f46d24f99486240f22f enabled: false mode: single   ","date":"2023-12-14T00:00:00Z","image":"https://loveflee.github.io/p/frigate/002_hu0ef56f75a8024440a0638948000910e6_132224_120x120_fill_q75_box_smart1.jpg","permalink":"https://loveflee.github.io/p/frigate/","title":"Docker Compose Frigate - NVR"},{"content":"åƒè€ƒä¾†æº https://blog.lass.cc/posts/how-to-build-hugo-with-docker/\næ–°å¢æ–‡ç«  mkdir ~/blog/src/content/post/newpostID nano ~/blog/src/content/post/newpostID/index.md ä»¥æœ¬ç¯‡ä¾†èªª mkdir ~/blog/src/content/post/docker01 cp ~/index.md ~/blog/src/content/post/docker01/ nano ~/blog/src/content/post/docker01/index.md\nè²¼åœ–èªæ³• 1 2 3 4 5  è²¼åœ–è¦åœ¨åŒç›®éŒ„ è²¼åœ–èªæ³• ![åœ–ç‰‡èªªæ˜æœƒåœ¨åœ–ä¸‹æ–¹](åœ–æª”æª”å.jpg) ç¯„ä¾‹ï¼š ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg)   ç™¼è¡¨æ–‡ç«  1  docker-compose up --build -d   ","date":"2023-11-30T00:00:00Z","image":"https://loveflee.github.io/p/hugo/docker_hu8fc112533065eda6f9a0c57ee748feb0_60918_120x120_fill_q75_box_smart1.jpg","permalink":"https://loveflee.github.io/p/hugo/","title":"docker compose Hugo"},{"content":"æ­£æ–‡æ¸¬è©¦ å¾ˆé›£ç©æ¨‚,æäº†å¥½ä¹…æ‰æ”¹ä¸€é»é»,ä¸è¦å•,å•å°±æ˜¯æç ¸äº†\u0026hellip;é€™ç‰ˆå‹æœ‰å–œæ­¡\u0026hellip;\nå¼•ç”¨  å¼•ç”¨çš„èªæ³•,ç•™ä¸‹ç•¶å‚™è¨»å§\u0026hellip;\næˆ³å®ƒè½æ­Œé–‹æ–°é é¢\u0026raquo; æœ€æš–çš„æ†‚å‚· - ç”°é¦¥ç”„\n è²¼åœ– è²¼åœ–èªæ³• 1 2 3  ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg)   ç›¸å†Œè¯­æ³•æ¥è‡ª Typlog\n","date":"2023-11-29T00:00:00Z","image":"https://loveflee.github.io/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu45a5e3ad5e058da6a00650ed8fd40bea_15530_120x120_fill_q75_box_smart1.jpg","permalink":"https://loveflee.github.io/p/test-chinese/","title":"Test 01"},{"content":"æœ¬æ–‡æä¾›äº†å¯åœ¨ Hugo å…§å®¹æª”æ¡ˆä¸­ä½¿ç”¨çš„åŸºæœ¬ Markdown èªæ³•ç¯„ä¾‹ï¼Œä¹Ÿå±•ç¤ºäº† Hugo ä¸»é¡Œä¸­æ˜¯å¦ä½¿ç”¨ CSS è£é£¾åŸºæœ¬ HTML å…ƒç´ \nHeadings æ¨™é¡Œ ä»¥ä¸‹ HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; ä»£è¡¨å…­å€‹éšç´šçš„ç« ç¯€æ¨™é¡Œ \u0026lt;h1\u0026gt; æœ€å¤§ \u0026lt;h6\u0026gt; æœ€å°\nH1 H2 H3 H4 H5 H6 Paragraph æ®µè½ å…§æ–‡åœ¨èªªæ•…äº‹,ç äº†\u0026hellip;\nBlockquotes å€å¡Šå¼•ç”¨ blockquote å…ƒç´ è¡¨ç¤ºå¾å…¶ä»–ä¾†æºå¼•ç”¨çš„å…§å®¹å¯é¸åœ°å¸¶æœ‰å¿…é ˆä½æ–¼orå…ƒç´ å…§çš„å¼•æ–‡ footer or cite ä¸¦ä¸”å¯é¸åœ°å¸¶æœ‰å…§è¯æ›´æ”¹ï¼ˆä¾‹å¦‚è¨»é‡‹å’Œç¸®å¯«ï¼‰\nBlockquote without attribution æ²’æœ‰æ­¸å±¬çš„å€å¡Šå¼•ç”¨  ç„¶å¾Œï¼Œç‚ºäº†é‘„é€ å®‰é”æ™®ï¼Œè¦çµ¦äºˆçš„çŸ¥è­˜æœƒè¢«ç›¸æ‡‰åœ°å‰Šæ¸›\næ³¨æ„ï¼Œå¯ä»¥åœ¨å€å¡Šå¼•ç”¨ä¸­ä½¿ç”¨Markdown èªæ³•\n Blockquote with attribution æœ‰æ­¸å±¬çš„å€å¡Šå¼•ç”¨  ä¸è¦é€éå…±äº«è¨˜æ†¶é«”ä¾†é€šä¿¡ï¼Œè€Œæ˜¯é€éé€šä¿¡ä¾†å…±äº«è¨˜æ†¶é«”\nâ€” Rob Pike1\n Tables è¡¨æ ¼ è¡¨æ ¼ä¸æ˜¯æ ¸å¿ƒ Markdown è¦ç¯„çš„ä¸€éƒ¨åˆ†ï¼Œä½† Hugo æ”¯æ´é–‹ç®±å³ç”¨åœ°æ”¯æ´å®ƒå€‘\n   Name Age     Bob 27   Alice 23    è¡¨æ ¼å…§å…§è¯ Markdown    Italics Bold Code     italics bold code       A B C D E F     Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien    Code Blocks ç¨‹å¼ç¢¼å€å¡Š Code block with backticks å¸¶æœ‰åå¼•è™Ÿçš„ç¨‹å¼ç¢¼å€å¡Š 1 2 3 4 5 6 7 8 9 10  \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   Code block indented with four spaces ç¨‹å¼ç¢¼å€å¡Šç¸®æ’å››å€‹ç©ºæ ¼ \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  Code block with Hugo\u0026rsquo;s internal highlight shortcode å¸¶æœ‰ Hugo å…§éƒ¨é«˜äº®çŸ­ä»£ç¢¼çš„ç¨‹å¼ç¢¼å€å¡Š 1 2 3 4 5 6 7 8 9 10  \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   Diff code block å·®ç•°ä»£ç¢¼å€å¡Š 1 2 3 4 5  [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;]   List Types æ¸…å–®é¡å‹ Ordered List æœ‰åºåˆ—è¡¨  First item Second item Third item  Unordered List ç„¡åºåˆ—è¡¨  List item Another item And another item  Nested list åµŒå¥—åˆ—è¡¨  Fruit  Apple Orange Banana   Dairy  Milk Cheese    Other Elements å…¶ä»–å…ƒç´  â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image åœ–ç‰‡è¶…é€£çµ \n  The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","date":"2019-03-11T00:00:00Z","image":"https://loveflee.github.io/p/markdown-%E6%96%87%E6%B3%95%E6%8C%87%E5%8D%97/pawel-czerwinski-8uZPynIu-rQ-unsplash_hud7e36f7e20e71be184458283bdae4646_55974_120x120_fill_q75_box_smart1.jpg","permalink":"https://loveflee.github.io/p/markdown-%E6%96%87%E6%B3%95%E6%8C%87%E5%8D%97/","title":"Markdown æ–‡æ³•æŒ‡å—"},{"content":"Hugo é™„å¸¶äº†å¤šå€‹ç”¨æ–¼è±å¯Œå…§å®¹çš„ å…§å»ºçŸ­ä»£ç¢¼ ä»¥åŠä¸€å€‹éš±ç§é…ç½®å’Œä¸€çµ„ç°¡å–®çš„çŸ­ä»£ç¢¼ éš±ç§é…ç½® ï¼Œå¯æ”¯æ´å„ç¨®ç¤¾äº¤åª’é«”åµŒå…¥çš„éœæ…‹å’Œç„¡ JS ç‰ˆæœ¬\n YouTube éš±ç§å¢å¼·ç°¡ç¢¼    Twitter ç°¡å–®ç°¡ç¢¼ .twitter-tweet { font: 14px/1.45 -apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif; border-left: 4px solid #2b7bb9; padding-left: 1.5em; color: #555; } .twitter-tweet a { color: #2b7bb9; text-decoration: none; } blockquote.twitter-tweet a:hover, blockquote.twitter-tweet a:focus { text-decoration: underline; }  â€œIn addition to being more logical, asymmetry has the advantage that its complete appearance is far more optically effective than symmetry.â€\nâ€” Jan Tschichold pic.twitter.com/gcv7SrhvJb\n\u0026mdash; Design Reviewed | Graphic Design History (@DesignReviewed) January 17, 2019  Vimeo ç°¡å–®ç°¡ç¢¼  .__h_video { position: relative; padding-bottom: 56.23%; height: 0; overflow: hidden; width: 100%; background: #000; } .__h_video img { width: 100%; height: auto; color: #000; } .__h_video .play { height: 72px; width: 72px; left: 50%; top: 50%; margin-left: -36px; margin-top: -36px; position: absolute; cursor: pointer; }   bilibilibi ç°¡ç¢¼ \r\rGist ç°¡ç¢¼  Gitlab ç‰‡æ®µç°¡ç¢¼  Quote ç°¡ç¢¼ Stack adds a quote shortcode. For example:\n Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• A famous person, The book they wrote  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• Anonymous book  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• Some book  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• Somebody","date":"2019-03-10T00:00:00Z","permalink":"https://loveflee.github.io/p/%E5%85%A7%E5%AE%B9%E8%B1%90%E5%AF%8C/","title":"å…§å®¹è±å¯Œ"},{"content":"Lorem est tota propiore conpellat pectoribus de pectora summo.\nRedit teque digerit hominumque toris verebor lumina non cervice subde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc caluere tempus inhospita parcite confusaque translucet patri vestro qui optatis lumine cognoscere flos nubis! Fronde ipsamque patulos Dryopen deorum.\nä»–å›ä¾†ä¸¦æ‘§æ¯€äº†ä½ ï¼Œæˆ‘æœƒå®³æ€•ç”·äººçš„æ‰˜é‡Œæ–¯ï¼Œä»–ä¸æœƒå¾è„–å­ä¸‹é¢æ‹¿èµ°ç‡ˆå…‰ï¼Œä»–æœ‰ä½¿ç”¨å’Œé˜¿å…‹é “ï¼Œä»–å€‘ä¸æ‰¿å—çš„æ†¤æ€’ã€‚ è€Œç•¶å±±è‰²æš–å’Œçš„æ™‚å€™ï¼Œè’æ¶¼çš„æ™‚å…‰å°±æœƒç¨€ç¨€æ‹‰æ‹‰åœ°ç…§åˆ°ä½ æƒ³èªè­˜é›²èŠ±çš„çˆ¶è¦ªèº«ä¸Šï¼ è‘‰å­å’Œçœ¾ç¥çš„å­©å­  Exierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude  Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus silentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria tractus malis.\n Comas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et  Vagus elidunt \nThe Van de Graaf Canon\nMane refeci capiebant unda mulcebat Victa caducifer, malo vulnere contra dicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere furit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.\nIubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli Lelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare Echionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert ausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae vulnus haerentia iuste et exercebat, sui et.\nEurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem Propoetides parte.\n","date":"2019-03-09T00:00:00Z","image":"https://loveflee.github.io/p/%E4%BD%94%E4%BD%8D%E7%AC%A6/matt-le-SJSpo9hQf7s-unsplash_hu958d513eeefe5556a31d065479ecc5ac_14205_120x120_fill_q75_box_smart1.jpg","permalink":"https://loveflee.github.io/p/%E4%BD%94%E4%BD%8D%E7%AC%A6/","title":"ä½”ä½ç¬¦"},{"content":"Hugo å°ˆæ¡ˆä¸­çš„æ•¸å­¸ç¬¦è™Ÿå¯ä»¥é€éä½¿ç”¨ç¬¬ä¸‰æ–¹ JavaScript å‡½å¼åº«ä¾†å•Ÿç”¨\nåœ¨æœ¬ä¾‹ä¸­æˆ‘å€‘å°‡ä½¿ç”¨ KaTeX\n åœ¨ä¸‹é¢å‰µå»ºä¸€å€‹éƒ¨åˆ† /layouts/partials/math.html åœ¨æ­¤éƒ¨åˆ†ä¸­å¼•ç”¨ è‡ªå‹•æ¸²æŸ“æ“´å……åŠŸèƒ½ æˆ–åœ¨æœ¬æ©Ÿä¸Šè¨—ç®¡é€™äº›è…³æœ¬ å°‡éƒ¨åˆ†å…§å®¹åŒ…å«åœ¨ç¯„æœ¬ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º:  1 2 3  {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }}    è‹¥è¦å…¨åŸŸå•Ÿç”¨ KaTexï¼Œè«‹å°‡åƒæ•¸è¨­å®š math to true å°ˆæ¡ˆé…ç½®ä¸­çš„ è‹¥è¦åœ¨æ¯é å•Ÿç”¨ KaTexï¼Œè«‹ math: true åœ¨å…§å®¹æª”æ¡ˆä¸­åŒ…å«è©²åƒæ•¸  æ³¨æ„: ä½¿ç”¨ Supported TeX Functions çš„ç·šä¸Šåƒè€ƒ\nExamples ç¯„ä¾‹ Inline math: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\nBlock math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n","date":"2019-03-08T00:00:00Z","permalink":"https://loveflee.github.io/p/%E6%95%B8%E5%AD%B8%E6%8E%92%E7%89%88/","title":"æ•¸å­¸æ’ç‰ˆ"},{"content":"å¯ä»¥é€éå¤šç¨®æ–¹å¼åœ¨ Hugo é …ç›®ä¸­å•Ÿç”¨è¡¨æƒ…ç¬¦è™Ÿ\nè¡¨æƒ…ç¬¦è™Ÿ å¯ä»¥ç›´æ¥åœ¨æ¨¡æ¿æˆ– Inline Shortcodes ä¸­å‘¼å«\nè‹¥è¦å…¨åŸŸå•Ÿç”¨è¡¨æƒ…ç¬¦è™Ÿï¼Œè«‹åœ¨ç¶²ç«™é…ç½® enableEmoji to true in your site\u0026rsquo;s configuration ç„¶å¾Œå¯ä»¥ç›´æ¥åœ¨å…§å®¹æª”æ¡ˆä¸­éµå…¥è¡¨æƒ…ç¬¦è™Ÿç°¡å¯«ç¨‹å¼ç¢¼\nğŸ™ˆ :see_no_evil: ğŸ™‰ :hear_no_evil: ğŸ™Š :speak_no_evil:\nThe Emoji cheat sheet æ˜¯è¡¨æƒ…ç¬¦è™Ÿé€Ÿè¨˜ä»£ç¢¼çš„æœ‰ç”¨åƒè€ƒ\n æ³¨æ„ æ³¨æ„ï¼šä¸Šè¿°æ­¥é©Ÿåœ¨ Hugo ä¸­å•Ÿç”¨äº† Unicode æ¨™æº–è¡¨æƒ…ç¬¦è™Ÿå­—å…ƒå’Œåºåˆ—ï¼Œä½†é€™äº›å­—å½¢çš„å‘ˆç¾å–æ±ºæ–¼ç€è¦½å™¨å’Œå¹³å°ã€‚è‹¥è¦è¨­å®šè¡¨æƒ…ç¬¦è™Ÿæ¨£å¼ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹è¡¨æƒ…ç¬¦è™Ÿå­—é«”æˆ–å­—é«”å †ç–Šï¼›ä¾‹å¦‚\n1 2 3  .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; }  ","date":"2019-03-05T00:00:00Z","image":"https://loveflee.github.io/p/%E8%A1%A8%E6%83%85%E7%AC%A6%E8%99%9F%E6%94%AF%E6%8C%81/the-creative-exchange-d2zvqp3fpro-unsplash_huf941de4769045cdfa8c9ee7036519a2a_35369_120x120_fill_q75_box_smart1.jpg","permalink":"https://loveflee.github.io/p/%E8%A1%A8%E6%83%85%E7%AC%A6%E8%99%9F%E6%94%AF%E6%8C%81/","title":"è¡¨æƒ…ç¬¦è™Ÿæ”¯æŒ"},{"content":"åƒè€ƒä¾†æº Intel Gpu  https://gist.github.com/scyto/e4e3de35ee23fdb4ae5d5a3b85c16ed3\nHost å®‰è£\n1 2  apt update \u0026amp;\u0026amp; apt install pve-headers-$(uname -r) apt install git sysfsutils dkms build-* unzip -y   æ–°å¢ apt sources.list intel non-free\n1  nano /etc/apt/sources.list   æ·»åŠ ä»¥ä¸‹\n1 2 3 4 5  #non-free firmwares deb http://deb.debian.org/debian bookworm non-free-firmware #non-free drivers and components deb http://deb.debian.org/debian bookworm non-free   å­˜æª”å¾ŒåŸ·è¡Œ\n1  apt update \u0026amp;\u0026amp; apt install intel-media-va-driver-non-free intel-gpu-tools vainfo   è¤‡è£½ proxmox å®‰è£ä¸­ç¼ºå°‘çš„é©…å‹•ç¨‹å¼ï¼Œä¸¦å°‡åœ¨ dmesg ä¸­åˆªé™¤æ­¤æª”çš„ -2 éŒ¯èª¤\n1 2 3  wget -r -nd -e robots=no -A \u0026#39;*.bin\u0026#39; --accept-regex \u0026#39;/plain/\u0026#39; https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/adlp_dmc.bin cp adlp_dmc.bin /lib/firmware/i915/   ç·¨è­¯ä¸¦å®‰è£æ–°é©…å‹•ç¨‹å¼ å…‹éš† github å°ˆæ¡ˆ\n1 2  cd ~ git clone https://github.com/strongtz/i915-sriov-dkms.git   ä¿®æ”¹ dkms.conf\n1 2  cd i915-sriov-dkms nano dkms.conf   æ›´æ”¹é€™å…©è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2  PACKAGE_NAME=\u0026#34;i915-sriov-dkms\u0026#34; PACKAGE_VERSION=\u0026#34;6.5\u0026#34;   ä¿å­˜æª”æ¡ˆ ç·¨è­¯å’Œå®‰è£é©…å‹•ç¨‹å¼\n1 2 3  cd ~ mv i915-sriov-dkms/ /usr/src/i915-sriov-dkms-6.5 dkms install --force -m i915-sriov-dkms -v 6.5   é©—è­‰æ¨¡çµ„æ˜¯å¦å·²å®‰è£\n1  dkms status   å¸è¼‰ dkms i915\n1  dkms remove i915-sriov-dkms/6.5   ä¿®æ”¹ grub\n1  nano /etc/default/grub   ä¿®æ”¹é€™ä¸€è¡Œ,å¦‚åŸæœ¬æœ‰å…¶ä»–æ–°å¢,ä¿æŒåŸæœ¬çš„ä¸è®Š,æ–°å¢ä¸Šå»\n1  GRUB_CMDLINE_LINUX_DEFAULT=\u0026#34;quiet intel_iommu=on iommu=pt i915.enable_guc=3 i915.max_vfs=7\u0026#34;   å­˜æª”é€€å‡º,æ›´æ–°grub\n1 2 3 4  update-grub update-initramfs -u #or update-initramfs -c -k all   å¦‚update-initramfs -u  å‡ºç¾ä»¥ä¸‹éŒ¯èª¤\n1 2 3  W: Possible missing firmware /lib/firmware/i915/mtl_gsc_102.0.0.1511.bin for module i915 W: Possible missing firmware /lib/firmware/i915/mtl_huc_8.4.3_gsc.bin for module i915 W: Possible missing firmware /lib/firmware/i915/mtl_guc_70.6.4.bin for module i915   https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  cd ~ \u0026amp;\u0026amp; mkdir less \u0026amp;\u0026amp; cd less wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/mtl_huc_gsc.bin -O mtl_huc_8.4.3_gsc.bin wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/mtl_guc_70.bin -O mtl_guc_70.6.4.bin wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/mtl_gsc_1.bin -O mtl_gsc_102.0.0.1511.bin cp mtl_gsc_102.0.0.1511.bin mtl_huc_8.4.3_gsc.bin mtl_guc_70.6.4.bin /lib/firmware/i915/ ###ä»¥ä¸‹æœªå„ªåŒ– cd ~;mkdir less;cd less wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/mtl_huc_gsc.bin cp mtl_huc_gsc.bin mtl_huc_8.4.3_gsc.bin wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/mtl_guc_70.bin cp mtl_guc_70.bin mtl_guc_70.6.4.bin wget https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915/mtl_gsc_1.bin cp mtl_gsc_1.bin mtl_gsc_102.0.0.1511.bin cp mtl_gsc_102.0.0.1511.bin /lib/firmware/i915/ cp mtl_huc_8.4.3_gsc.bin /lib/firmware/i915/ cp mtl_guc_70.6.4.bin /lib/firmware/i915/   è£œå®Œé©…å‹•\n1 2 3  update-initramfs -u #or update-initramfs -c -k all   zfs uefi\n1  nano /etc/kernel/cmdline   ä¿®æ”¹\n1  root=ZFS=rpool/ROOT/pve-1 boot=zfs intel_iommu=on iommu=pt i915.enable_guc=3 i915.max_vfs=7   æŸ¥æ‰¾PCIeç¸½ç·šä¸¦æ›´æ–° sysfs.conf\n1  lspci | grep VGA   å„ä»£intel cpu æ”¯æ´çš„gpuè™›æ“¬åŒ–åˆ—è¡¨ https://www.intel.com.tw/content/www/tw/zh/support/articles/000093216/graphics/processor-graphics.html åªæœ‰10ä»£ä»¥ä¸Šæ”¯æ´VGPU æ‡‰è©²è¼¸å‡º\n1  00:02.0 VGA compatible controller: Intel Corporation CoffeeLake-H GT2 [UHD Graphics 630] (rev 02)   å–æœ€å·¦é‚Šçš„æ•¸çµ„ï¼Œä¸¦æŒ‰å¦‚ä¸‹æ–¹å¼æ·»åŠ åˆ° sysfs.conf ä¸­ æ³¨æ„ï¼Œç¸½ç·šè·¯å¾‘ä¸Šçš„æ‰€æœ‰å¾ŒçºŒé›¶éƒ½æ˜¯å¿…éœ€çš„\n1  echo \u0026#34;devices/pci0000:00/0000:00:02.0/sriov_numvfs = 7\u0026#34; \u0026gt; /etc/sysfs.conf   å­˜æª”é€€å‡º reboot æª¢æŸ¥è¨­å‚™\n1  dmesg | grep i915   æœ€å¾Œå…©è¡Œæ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2  [ 7.591662] [drm] Initialized i915 1.6.0 20201103 for 0000:00:02.7 on minor 7 [ 7.591818] i915 0000:00:02.0: Enabled 7 VFs   å¦‚æœæ²’æœ‰è¼¸å‡ºï¼Œè«‹ä»”ç´°æª¢æŸ¥æ‰€æœ‰æ­¥é©Ÿ ä½¿ç”¨ VAInfo é€²è¡Œé©—è­‰/cardN Nç‚º0-7(VGPUç·¨è™Ÿ),å¹³å°ä¸åŒæ•¸é‡ä¸åŒ 10ä»£1 13ä»£7\n1  vainfo --display drm --device /dev/dri/cardN   æª¢æŸ¥æ˜¯å¦å¯ä»¥ç›£æ§ VF å¦‚æœæ²’æœ‰ï¼Œæœ‰å•é¡Œ\n1 2 3  intel_gpu_top -d drm:/dev/dri/renderD128 ls -l /dev/dri   åœ¨ Proxmox ä¸­é…ç½® vGPU æ±   Datacenter(è³‡æ–™ä¸­å¿ƒ) \u0026gt; Resource Mappings  æŒ‰å…©ä¸‹PCIè¨­å‚™add  å°‡æ± å‘½åç‚ºvGPU-Pool  æ˜ å°„ pve 1 çš„æ‰€æœ‰ 7 å€‹ VFï¼Œä½†ä¸æ˜ å°„æ ¹è¨­å‚™ï¼Œå³ 0000ï¼š00ï¼š02.x è€Œä¸æ˜¯ 0000ï¼š00ï¼š02 é»æ“Šcreate  åœ¨å‰µå»ºçš„æ±  lcikc ä¸Šï¼ŒvGPU-Pool æ—é‚Šçš„åŠ è™ŸæŒ‰éˆ•  é¸æ“‡ç¯€é»ä¸Šçš„æ˜ å°„ = PVE 2ï¼ŒAD æ‰€æœ‰è¨­å‚™ï¼Œç„¶å¾ŒæŒ‰å…©ä¸‹å‰µå»º å° PVE3 é‡è¤‡ä¸Šè¿°æ­¥é©Ÿ  æ³¨æ„ï¼šå…·æœ‰PCIç›´é€šè¨­å‚™çš„è¨ˆç®—æ©Ÿç„¡æ³•å³æ™‚é·ç§»ï¼Œå¿…é ˆå°‡å…¶é—œé–‰ï¼Œé›¢ç·šé·ç§»åˆ°æ–°ç¯€é»ï¼Œç„¶å¾Œå•Ÿå‹•  æ¯æ¬¡åœ¨PROXMOXä¸­æ›´æ–°å…§æ ¸æ™‚ï¼Œéƒ½æ‡‰è©²åŸ·è¡Œä»¥ä¸‹æ“ä½œ update the kernel using proxox ui\n1 2  dkms install -m i915-sriov-dkms -v 6.5 --force reboot    åœ¨ä¸å¸¶ vGPU çš„æƒ…æ³ä¸‹å•Ÿå‹•VMï¼Œä¸¦å°‡é¡¯ç¤ºè¨­ç½®ç‚ºé è¨­å€¼ å®‰è£ VirtIO é©…å‹•ç¨‹å¼ é—œé–‰è™›æ“¬æ©Ÿä¸¦å°‡é¡¯ç¤ºæ›´æ”¹ç‚º VirtIO-GPU å°‡CPUé¡å‹æ›´æ”¹ç‚ºâ€œhostâ€ ç¾åœ¨å°‡ vGPU æ± æ·»åŠ ç‚º PCI è¨­å‚™ å‰µå»º VM æ™‚ï¼Œæ·»åŠ  PCI è¨­å‚™ä¸¦æ·»åŠ  pooolï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ç¾åœ¨å•Ÿå‹•åˆ° VM ä¸¦å®‰è£è‹±ç‰¹çˆ¾æä¾›çš„æœ€æ–° IrisXe é©…å‹•ç¨‹å¼ ç¾åœ¨ï¼Œç„¡è«–é€šé webcolse VNCã€SPICE é‚„æ˜¯ RDP ç”¨æˆ¶ç«¯é€£æ¥ï¼Œéƒ½æ‡‰è©²æœ‰åœ–å½¢åŠ é€Ÿ\n æŒ‰ç…§æŒ‡å—æ“ä½œï¼Œåœ¨è¨­å‚™ç®¡ç†å™¨ä¸­çœ‹åˆ° Microsoft åŸºæœ¬é¡¯ç¤ºé©é…å™¨ - å¦‚æœåœ¨ VM è¨­ç½®ä¸­ä½¿ç”¨â€œé¡¯ç¤ºâ€ Intel iGPU - ç›´é€š æœ‰ 2 å€‹ï¼ˆæˆ–æ›´å¤šï¼‰é¸é …ä¾†ä½¿ç”¨ iGPUã€‚å› ç‚º Windows 11 è‡ªè¡Œæ±ºå®šä½¿ç”¨å“ªç¨®åœ–å½¢\nç·¨è¼¯windiws11 VM conf æª”ä¸¦æ·»åŠ \n1  args: -cpu Cooperlake,hv_relaxed,hv_spinlocks=0x1fff,hv_vapic,hv_time,+vmx   èˆŠ cpu 6-10 ç›´é€šåŒ…æ‹¬ç¨é¡¯+é–‹å•Ÿå…§é¡¯GVT-G https://home.gamer.com.tw/creationDetail.php?sn=5516262  å¼€å¯iommuå’ŒGVT-gæ”¯æŒ https://www.xh86.me/?p=741\n1  nano /etc/kernel/cmdline   ä¸è¦æ›è¡Œï¼Œå¾€å¾ŒåŠ æŒ‡ä»¤\n1  root=ZFS=rpool/ROOT/pve-1 boot=zfs intel_iommu=on iommu=pt pcie_acs_override=downstream video=efifb:off,vesafb:off i915.enable_guc=3 i915.max_vfs=2   æŒ‡ä»¤è§£é‡‹ï¼š intel_iommu=on æœ€ç™½è©±çš„è¨­å®šï¼Œé–‹å•ŸIOMMU iommu=pt è½èªªæ˜¯åŠ å¼·IOMMUçš„æ€§èƒ½ï¼Œä¹Ÿæœ‰äººèªªä¸åŠ ä¹Ÿæ²’å·®ï¼Œå› ç‚ºæ‡¶å¾—æ¯”è¼ƒï¼Œæˆ‘å°±æ²’æ‹¿æ‰ pcie_acs_override=downstream é€™å€‹ä¼¼ä¹æ˜¯åŠ å¼·PCIEè£ç½®çš„åˆ†çµ„ï¼Œæˆ‘å€‹äººç†è§£æ˜¯ï¼š æ²’åŠ é€™è¡Œ=åˆ†çµ„å¾Œç›´é€šé¡¯å¡æœƒåŒ…å«ç¹ªåœ–è£ç½®è·Ÿè²éŸ³è£ç½®ï¼Œç›´é€šä¸€å€‹å¦ä¸€å€‹æœƒè·Ÿè‘—è¢«ç›´é€š åŠ å…¥é€™è¡Œ=åˆ†çµ„å¾Œå¯ä»¥æŠŠç¹ªåœ–è£ç½®è·Ÿè²éŸ³è£ç½®åˆ†åˆ¥ç›´é€šçµ¦ä¸åŒVM video=efifb:off,vesafb:off åŒ…åˆ®äº†videoçš„å…©å€‹è¨­å®šï¼š efifb:offæ˜¯efié–‹æ©Ÿå¾Œè¼‰å…¥fb0çš„è¨­å®šï¼Œoffçš„è©±ç•¶ç„¶å°±æ˜¯ä¸è¦é–‹å•Ÿå•¦XD vesafb:offæ˜¯vesaç¨‹åºè¼‰å…¥fb0çš„è¨­å®šï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯å•¥ï¼Œåæ­£å¾ˆå¤šäººåœ¨ç›´é€šæ™‚æŠŠé€™è¡Œä¹ŸåŠ ä¸Šå»äº†ï¼Œæ²’è©¦éä¸åŠ ï¼Œç¸½ä¹‹å°±è·Ÿè‘—åŠ äº†ï¼Œä¹Ÿæ˜¯è¨­å®šä¸è¦é–‹å•Ÿ  modprobe.dè£¡é¢çš„confæª”åšè¨­å®š\n1  nano /etc/modprobe.d/user.conf   æª”æ¡ˆå…§å®¹ï¼Œç›´æ¥ç”¨è¨»è§£çš„æ–¹å¼è§£é‡‹æ¯å€‹åœ¨åšå•¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  # é»‘åå–®ï¼Œä¸è®“ç¨‹å¼é–‹æ©Ÿå°±è¼‰å…¥ä¸‹é¢çš„é©…å‹•ç¨‹å¼ï¼Œé¡¯å¡æ‰èƒ½å¤ ç›´é€š # Aå¡çš„é©…å‹•ï¼Œæˆ‘ä¸æƒ³æ”¹å°±æ²’æ‹¿æ‰äº† # Nå¡çš„linuxå…§å»ºåŸºæœ¬é©…å‹• # Nå¡çš„é©…å‹• # ä¸»æ©Ÿæ¿è²éŸ³å¡çš„é©…å‹•ç¨‹å¼ # blacklist to stop driver loading blacklist radeon blacklist nouveau blacklist nvidia blacklist snd_hda_intel # code43è¿´é¿æ–¹å¼ # è½èªªVMæœƒå‡ºç¾code 43ï¼Œæ˜¯ç”±æ–¼é¡¯å¡çŸ¥é“è‡ªå·±åœ¨è™›æ“¬ç’°å¢ƒè€Œç™¼error # ç”¨ä¸‹é¢çš„æŒ‡ä»¤è®“é¡¯å¡ä¸ç™¼error # ä¸ç¢ºå®šï¼Œç¸½ä¹‹æˆ‘æ˜¯é€™æ¨£èªç‚º~ # kvm config to avoid code 43 options kvm ignore_msrs=1 #options report_ignored_msrs=0 #å ±éŒ¯ä¿®æ”¹ç‚ºä¸‹é¢ options kvm report_ignored_msrs=N # å…è¨±vfioæ¨¡çµ„ç™¼å‡ºä¸­æ–·ï¼Œæ‡‰è©²æ˜¯é€™æ¨£ # å› ç‚ºä¹‹å¾Œæœƒè¼‰å…¥å»çµ¦PCIEè£ç½®ï¼Œé€™é‚Šè¦è¨­å®šå…è¨± # IOMMU interrupts options vfio_iommu_type1 allow_unsafe_interrupts=1 # GVT-Gé…ç½® # gvt: çœ‹è‡ªå·±è¦ä¸è¦ç©GVT-Gï¼Œè¦=1ï¼Œä¸è¦=0 # guc: æ˜¯å¦é–‹å•Ÿä½åŠŸè€—ä»€éº¼çš„ï¼Œæœ‰GVT-Gåªèƒ½=0ï¼Œå¦å‰‡æƒ³é–‹=2/3 (3è¦çœ‹CPUæ˜¯å¦æ”¯æ´huc) # INTEL Graphic config options i915 enable_gvt=1 #options i915 enable_guc=0 # è¨­å®šZFSåªèƒ½ä½¿ç”¨é€™éº¼å¤šè¨˜æ†¶é«” # è¨­å®šé‚è¼¯å°±æ˜¯é è¨­2G + ((å„²å­˜ç©ºé–“æ¯1T)=1G) * (16+1+1) = 20Gï¼Œç„¶å¾Œæ›ç®—æˆbyte # ZFS config #options zfs zfs_arc_max=21474836480   æ­¤ç¯‡çµæŸ!\nXeon e3 v5-6 core 5-7 åƒè€ƒ https://www.xh86.me/?p=741 intel gvt-gæŠ€è¡“ï¼Œç›®å‰åªæ”¯æ´ç¬¬äº”ä»£ï¼Œç¬¬å…­ä»£å’Œç¬¬ä¸ƒä»£è‹±ç‰¹çˆ¾coreè™•ç†å™¨ä»¥åŠE3 v4ï¼ŒE3 v5å’ŒE3 v6 Xeonè™•ç†å™¨ é–‹å•Ÿiommuå’ŒGVT-g åƒè€ƒ2 https://cetteup.com/216/how-to-use-an-intel-vgpu-for-plexs-hardware-accelerated-streaming-in-a-proxmox-vm/\n1 2 3 4  #grub nano /etc/default/grub #or zfs uefi nano /etc/kernel/cmdline   ä¿®æ”¹\n1 2 3 4  #grub GRUB_CMDLINE_LINUX_DEFAULT=\u0026#34;quiet intel_iommu=on i915.enable_gvt=1\u0026#34; #zfs uefi root=ZFS=rpool/ROOT/pve-1 boot=zfs intel_iommu=on iommu=pt i915.enable_gvt=1   å¢åŠ ç›´é€šå†…æ ¸æ¨¡å¡Š\n1 2 3 4 5  echo vfio \u0026gt;\u0026gt; /etc/modules echo vfio_iommu_type1 \u0026gt;\u0026gt; /etc/modules echo vfio_pci \u0026gt;\u0026gt; /etc/modules echo vfio_virqfd \u0026gt;\u0026gt; /etc/modules echo kvmgt \u0026gt;\u0026gt; /etc/modules   æŸ¥çœ‹é¡¯å¡ç·¨è™Ÿ(ç¤ºä¾‹:ç·¨è™Ÿéœ€ä¿®æ”¹æˆè‡ªå·±çš„)\n1 2  lspci -n -s 00:02.0 00:02.0 0380: 8086:3e90   å°‡ 8086:3e90 åŠ å…¥ç›´é€š\n1  echo \u0026#34;options vfio-pci ids=8086:3e90\u0026#34; \u0026gt; /etc/modprobe.d/vfio.conf   æ›´æ–°grubèˆ‡é–‹æ©Ÿè¼‰å…¥æ¨¡å¡Š\n1 2  update-grub update-initramfs -c -k all   é©—è­‰ (02ç‚ºintel gpu å¦‚ä¸åŒæ›æˆè¨­å‚™ç·¨è™Ÿ)\n1  ls /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/      ","date":"2019-01-02T00:00:00Z","permalink":"https://loveflee.github.io/p/intel/","title":"plex2"},{"content":"plex åƒè€ƒä¾†æº https://jocke.no/2022/02/23/plex-gpu-transcoding-in-docker-on-lxc-on-proxmox/\nPve host ç‰¹æ¬Š LxcåŠŸèƒ½:fuse=1,nesting=1 ä¸»æ©Ÿå’Œ LXC å®¹å™¨éƒ½éœ€è¦é‹è¡Œç›¸åŒçš„é©…å‹•ç¨‹å¼ç‰ˆæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13  #é©…å‹•é»‘åå–®:é–‹æ©Ÿä¸è¼‰å…¥ echo -e \u0026#34;blacklist nouveau\\noptions nouveau modeset=0\u0026#34; \u0026gt; /etc/modprobe.d/blacklist-nouveau.conf nano /etc/kernel/cmdline add root=ZFS=rpool/ROOT/pve-1 boot=zfs intel_iommu=on #æ›´æ–°é–‹æ©Ÿæ¨¡çµ„ update-initramfs -u proxmox-boot-tool refresh #å®‰è£ç„¡é ­é©…å‹• apt install pve-headers-$(uname -r) #nvidia drive wget -O NVIDIA-Linux-x86_64-510.47.03.run https://us.download.nvidia.com/XFree86/Linux-x86_64/510.47.03/NVIDIA-Linux-x86_64-510.47.03.run chmod +x NVIDIA-Linux-x86_64-510.47.03.run   answer \u0026ldquo;no\u0026rdquo; when it asks if you want to install 32bit compability drivers å›ç­”â€œå¦â€ç•¶å®ƒè©¢å•æ‚¨æ˜¯å¦è¦å®‰è£ 32 ä½å…ƒç›¸å®¹é©…å‹•ç¨‹å¼æ™‚ answer \u0026ldquo;no\u0026rdquo; when it asks if it should update X config å›ç­”â€œå¦â€ç•¶å®ƒè©¢å•æ˜¯å¦æ‡‰è©²æ›´æ–° X-windows é…ç½®æ™‚\n1  ./NVIDIA-Linux-x86_64-510.47.03.run   æ–°å¢ä¸€äº› udev è¦å‰‡ã€‚é€™æ˜¯ç‚ºäº†ç¢ºä¿è¼‰å…¥æ­£ç¢ºçš„æ ¸å¿ƒæ¨¡çµ„ï¼Œä¸¦åœ¨å•Ÿå‹•æ™‚å»ºç«‹æ‰€æœ‰ç›¸é—œçš„è¨­å‚™æª”æ¡ˆ\n1  echo -e \u0026#39;\\n# load nvidia modules\\nnvidia-drm\\nnvidia-uvm\u0026#39; \u0026gt;\u0026gt; /etc/modules-load.d/modules.conf   å°‡ä»¥ä¸‹å…§å®¹æ·»åŠ åˆ° /etc/udev/rules.d/70-nvidia.rules å•Ÿå‹•æ™‚æœƒåœ¨/dev/ä¸­å»ºç«‹ç›¸é—œçš„è£ç½®æ–‡ä»¶\n1  nano /etc/udev/rules.d/70-nvidia.rules   æ·»åŠ ä»¥ä¸‹\n1 2 3  KERNEL==\u0026#34;nvidia\u0026#34;, RUN+=\u0026#34;/bin/bash -c \u0026#39;/usr/bin/nvidia-smi -L \u0026amp;\u0026amp; /bin/chmod 666 /dev/nvidia*\u0026#39;\u0026#34; KERNEL==\u0026#34;nvidia_uvm\u0026#34;, RUN+=\u0026#34;/bin/bash -c \u0026#39;/usr/bin/nvidia-modprobe -c0 -u \u0026amp;\u0026amp; /bin/chmod 0666 /dev/nvidia-uvm*\u0026#39;\u0026#34; SUBSYSTEM==\u0026#34;module\u0026#34;, ACTION==\u0026#34;add\u0026#34;, DEVPATH==\u0026#34;/module/nvidia\u0026#34;, RUN+=\u0026#34;/usr/bin/nvidia-modprobe -m\u0026#34;   é¿å…åœ¨ä¸ä½¿ç”¨ GPU æ™‚å¸è¼‰é©…å‹•ç¨‹å¼/æ ¸å¿ƒæ¨¡çµ„ï¼Œæ‡‰è©²åŸ·è¡Œ Nvidia æä¾›çš„æŒä¹…æ€§æœå‹™,é©…å‹•ç¨‹å¼å®‰è£å¾Œå°±å¯ä»¥ä½¿ç”¨å®ƒ https://docs.nvidia.com/deploy/driver-persistence/index.html\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  # è¤‡è£½ä¸¦è§£å£“ç¸® cp /usr/share/doc/NVIDIA_GLX-1.0/samples/nvidia-persistenced-init.tar.bz2 . bunzip2 nvidia-persistenced-init.tar.bz2 tar -xf nvidia-persistenced-init.tar # åˆªé™¤èˆŠçš„ï¼ˆå¦‚æœæœ‰çš„è©±,ä»¥é¿å…å±è”½æœå‹™ï¼‰ rm /etc/systemd/system/nvidia-persistenced.service # å®‰è£ chmod +x nvidia-persistenced-init/install.sh ./nvidia-persistenced-init/install.sh # æª¢æŸ¥æ˜¯å¦æ­£å¸¸ systemctl status nvidia-persistenced.service rm -rf nvidia-persistenced-init*   å¦‚æœæ²’æœ‰ä»»ä½•éŒ¯èª¤ï¼Œå°±å¯ä»¥é‡æ–°å•Ÿå‹• Proxmox ä¸»æ©Ÿã€‚é‡æ–°å•Ÿå‹•å¾Œï¼Œæ‡‰è©²æœƒçœ‹åˆ°ä»¥ä¸‹è¼¸å‡º ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  nvidia-smi +-----------------------------------------------------------------------------+ | NVIDIA-SMI 390.157 Driver Version: 390.157 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | |===============================+======================+======================| | 0 GeForce GTX 650 Off | 00000000:05:00.0 N/A | N/A | | 27% 42C P8 N/A / N/A | 183MiB / 978MiB | N/A Default | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: GPU Memory | | GPU PID Type Process name Usage | |=============================================================================| | 0 Not Supported | +-----------------------------------------------------------------------------+   æ·»åŠ  Lxc conf å…§å®¹ æ³¨æ„Pvehost group ID,æ¯å°ä¸»æ©Ÿä¸ä¸€,éœ€ä¿®æ­£ Pve host:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  ls -alh /dev/nvidia* crw-rw-rw- 1 root root 195, 0 12æœˆ 15 07:01 /dev/nvidia0 crw-rw-rw- 1 root root 195, 255 12æœˆ 15 07:01 /dev/nvidiactl crw-rw-rw- 1 root root 195, 254 12æœˆ 15 07:02 /dev/nvidia-modeset crw-rw-rw- 1 root root 510, 0 12æœˆ 15 07:01 /dev/nvidia-uvm crw-rw-rw- 1 root root 510, 1 12æœˆ 15 07:01 /dev/nvidia-uvm-tools /dev/nvidia-caps: ç¸½ç”¨é‡ 0 drw-rw-rw- 2 root root 80 12æœˆ 15 07:01 . drwxr-xr-x 23 root root 5.6K 12æœˆ 15 11:20 .. cr-------- 1 root root 236, 1 12æœˆ 15 07:01 nvidia-cap1 cr--r--r-- 1 root root 236, 2 12æœˆ 15 07:01 nvidia-cap2 lxc conf add lxc.cgroup2.devices.allow: c 195:* rwm lxc.cgroup2.devices.allow: c 510:* rwm lxc.cgroup2.devices.allow: c 236:* rwm lxc.mount.entry: /dev/nvidia0 dev/nvidia0 none bind,optional,create=file lxc.mount.entry: /dev/nvidiactl dev/nvidiactl none bind,optional,create=file lxc.mount.entry: /dev/nvidia-uvm dev/nvidia-uvm none bind,optional,create=file lxc.mount.entry: /dev/nvidia-modeset dev/nvidia-modeset none bind,optional,create=file lxc.mount.entry: /dev/nvidia-uvm-tools dev/nvidia-uvm-tools none bind,optional,create=file lxc.mount.entry: /dev/nvidia-uvm-tools dev/nvidia-caps/nvidia-cap1 none bind,optional,create=file lxc.mount.entry: /dev/nvidia-uvm-tools dev/nvidia-caps/nvidia-cap2 none bind,optional,create=file   Lxc å®¹å™¨å…§æ“ä½œ Lxcé–‹æ©Ÿ,é€²å…¥LxcåŸ·è¡Œä»¥ä¸‹\n1 2 3 4 5 6 7  wget -ONVIDIA-Linux-x86_64-510.47.03.run https://us.download.nvidia.com/XFree86/Linux-x86_64/510.47.03/NVIDIA-Linux-x86_64-510.47.03.run chmod +x NVIDIA-Linux-x86_64-510.47.03.run ./NVIDIA-Linux-x86_64-510.47.03.run --check # answer \u0026#34;no\u0026#34; when it asks if it should update X config ./NVIDIA-Linux-x86_64-510.47.03.run --no-kernel-module #å®‰è£å®Œé©…å‹•,é©—è­‰Lxc nvidia-smiè¼¸å‡º,å¦‚éŒ¯èª¤ï¼æª¢æŸ¥é©…å‹•ç‰ˆæœ¬èˆ‡hostä¸€è‡´å¦èˆ‡ lxc.conf nvidia-smi   å®‰è£ docker ç›¸é—œ\n1 2 3 4 5 6 7 8 9 10 11 12  #åˆªé™¤ä½¿ç”¨aptå®‰è£ä¹‹docker apt remove docker-compose docker docker.io containerd runc # å¾å®˜æ–¹å„²å­˜åº«å®‰è£ docker apt update apt install ca-certificates curl gnupg lsb-release curl -fsSL https://download.docker.com/linux/debian/gpg | gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg echo \\ \u0026#34;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian \\ $(lsb_release -cs) stable\u0026#34; | tee /etc/apt/sources.list.d/docker.list \u0026gt; /dev/null apt update apt install docker-ce docker-ce-cli containerd.io   å®‰è£ docker-compose\n1 2  curl -L \u0026#34;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)\u0026#34; -o /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose   docker-compose bash è£œå…¨\n1 2 3  curl \\ -L https://raw.githubusercontent.com/docker/compose/1.29.2/contrib/completion/bash/docker-compose \\ -o /etc/bash_completion.d/docker-compose   å®‰è£ nvidia-docker2 æ–°ç‰ˆæœ¬çš„å·¥å…·åŒ…éœ€è¦ä¸åŒçš„å„²å­˜åº«\n1 2 3 4 5 6 7 8 9 10  apt install -y curl distribution=$(. /etc/os-release;echo $ID$VERSION_ID) keyring_file=\u0026#34;/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg\u0026#34; curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | gpg --dearmor -o ${keyring_file} curl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.list | \\ sed \u0026#34;s#deb https://#deb [signed-by=${keyring_file}] https://#g\u0026#34; | \\ tee /etc/apt/sources.list.d/nvidia-container-toolkit.list apt update apt install nvidia-docker2   é‡æ–°å•Ÿå‹•systemd + dockerï¼ˆä¸é‡æ–°è¼‰å…¥systemdï¼Œdocker å¯èƒ½ç„¡æ³•é‹ä½œï¼‰\n1 2  systemctl daemon-reload systemctl restart docker   Plex docker compose 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  version: \u0026#39;3.7\u0026#39; services: plex: container_name: plex hostname: plex image: linuxserver/plex:latest restart: unless-stopped deploy: resources: reservations: devices: - capabilities: [gpu] environment: TZ: Europe/Paris PUID: 0 PGID: 0 VERSION: latest NVIDIA_VISIBLE_DEVICES: all NVIDIA_DRIVER_CAPABILITIES: compute,video,utility network_mode: host volumes: - /srv/config/plex:/config - /storage/media:/data/media - /storage/temp/plex/transcode:/transcode - /storage/temp/plex/tmp:/tmp   å…§æ ¸æœ‰æ›´æ–°æ™‚éœ€ å¸è¼‰nvidia-driveé‡æ–°å®‰è£pve-headers,é‡é–‹å¾Œé‡å®‰è£nvidiaé©…å‹•èˆ‡pve-headers\n1 2  ./NVIDIA-Linux-x86_64-510.47.03.run --uninstall apt install pve-headers-$(uname -r)    ","date":"2019-01-01T00:00:00Z","permalink":"https://loveflee.github.io/p/nvidia/","title":"plex"}]